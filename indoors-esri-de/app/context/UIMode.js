define(["require","exports","./Context","./Topic"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function l(){var t=this;this.expanded=!1,this.isAndroid=!1,this.isIOS=!1,this.isKiosk=!1,this.isTouch=!1,o.default.subscribe(o.default.AppStarted,function(e){t.mode&&t.moveViewTools(null,t.mode)})}return l.prototype.applyTheme=function(n){n&&Object.keys(n).forEach(function(t){if("string"==typeof t&&0<t.length){var o=n[t];if(null!=o){try{var e=t;0!==e.indexOf("--i-")&&(e="--i-"+e),document.documentElement.style.setProperty(e,o)}catch(e){console.warn("Error applying theme property, key:",t,"value:",o),console.error(e)}}}})},l.prototype.getCssVariable=function(e){return"string"==typeof e&&0<e.length&&0!==e.indexOf("--")&&(e="--"+e),window.getComputedStyle(document.documentElement,null).getPropertyValue(e)},l.prototype.getLogoUrl=function(){var e,t,o=function(e,t){return 0===e.indexOf(t)},n=function(e,t){return e.substring(e.length-t.length,e.length)===t},i=this.getCssVariable("--i-logo-url");return"string"==typeof i&&(0<(i=i.trim()).length&&(o(i,"url(")&&n(i,")")&&(i=(i=i.substring(4)).substring(0,i.length-1)),i=(e=i,t='"',o(e,t)&&n(e,t)?(e=e.substring(t.length)).substring(0,e.length-t.length):e).trim(i,"'").trim()),0===i.indexOf("../../../")&&(i=i.substring(7)),0<i.length)?i:null},l.prototype.init=function(){var o=this,e=!1,t=!1,n=!1;try{e=this.isAndroid=/Android/i.test(navigator.userAgent),t=this.isIOS=/iPhone|iPad|iPod/i.test(navigator.userAgent),"ontouchstart"in document.documentElement&&(this.isTouch=!0,"onorientationchange"in window&&(n=!0)),document.body.classList.contains("i-kiosk")&&(this.isKiosk=!0),this.applyTheme()}catch(e){console.warn("UIMode::init error"),console.error(e)}var i=window.matchMedia("screen and (max-width: 481px) and (orientation: portrait)"),r=window.matchMedia("screen and (max-height: 481px) and (orientation: landscape)"),s=function(){var e=o.mode,t=document.body;o.mode=l.MODE_HORIZONTAL_SPLIT,t.classList.add(l.MODE_HORIZONTAL_SPLIT),t.classList.remove(l.MODE_VERTICAL_SPLIT,l.MODE_NORMAL),setTimeout(function(){o.moveViewTools(e,l.MODE_HORIZONTAL_SPLIT)},250)},a=function(){var e=o.mode,t=document.body;o.mode=l.MODE_VERTICAL_SPLIT,t.classList.add(l.MODE_VERTICAL_SPLIT),t.classList.remove(l.MODE_HORIZONTAL_SPLIT,l.MODE_NORMAL),o.moveViewTools(e,l.MODE_VERTICAL_SPLIT)},c=function(){var e,t;i.matches?a():r.matches?s():(e=o.mode,t=document.body,o.mode=l.MODE_NORMAL,t.classList.add(l.MODE_NORMAL),t.classList.remove(l.MODE_VERTICAL_SPLIT,l.MODE_HORIZONTAL_SPLIT),o.moveViewTools(e,l.MODE_NORMAL))};try{if(!this.isKiosk)if(c(),this.mode!==l.MODE_HORIZONTAL_SPLIT&&this.mode!==l.MODE_VERTICAL_SPLIT||!e&&!t||!n)e||(i.addListener(function(){return c()}),r.addListener(function(){return c()}));else if(window.addEventListener("orientationchange",function(){var e=null;"number"==typeof(e=screen&&screen.orientation?screen.orientation.angle:window.orientation)&&(0===e||180===e?a():90!==e&&-90!==e&&270!==e||s())}),navigator.userAgent.match(/iPhone/i)){var d=document.querySelector('meta[name="viewport"]');d&&(d.content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=yes")}}catch(e){console.warn("UIMode::init error"),console.error(e)}},l.prototype.modeIsHorizontalSplit=function(){return this.mode===l.MODE_HORIZONTAL_SPLIT},l.prototype.modeIsNormal=function(){return this.mode===l.MODE_NORMAL},l.prototype.modeIsVerticalSplit=function(){return this.mode===l.MODE_VERTICAL_SPLIT},l.prototype.moveViewTools=function(e,n){if(e!==n){var t=function(e){if(e){var t=null,o=null;n===l.MODE_HORIZONTAL_SPLIT?(t="top-left",o="bottom-right"):(t="bottom-right",o="top-left"),function(o,e,n){var t=null;if(o&&e&&n){var i=o.ui._cornerNameToContainerLookup[e];i&&i.children&&(t=Array.prototype.slice.call(i.children))}t&&t.forEach(function(e){var t=o.ui.find(e);t&&t.widget&&o.ui.move(t,n)})}(e,t,o)}};try{var o=i.default.getInstance().views;o&&(t(o.mapView),t(o.sceneView))}catch(e){console.warn("UIMode::moveViewTools error"),console.error(e)}}},l.prototype.toggleExpanded=function(){this.expanded=!this.expanded},l.MODE_HORIZONTAL_SPLIT="i-mode-horizontal-split",l.MODE_VERTICAL_SPLIT="i-mode-vertical-split",l.MODE_NORMAL="i-mode-normal",l}();t.default=n});