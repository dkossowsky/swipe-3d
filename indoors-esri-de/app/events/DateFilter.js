var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),__decorate=this&&this.__decorate||function(e,t,n,a){var o,r=arguments.length,i=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(i=(r<3?o(i):3<r?o(t,n,i):o(t,n))||i);return 3<r&&i&&Object.defineProperty(t,n,i),i};define(["require","exports","esri/core/tsSupport/declareExtendsHelper","esri/core/tsSupport/decorateHelper","../context/Context","../common/Calendar","../common/ChoiceDropdown","../utils/dateUtil","esri/core/accessorSupport/decorators","esri/widgets/support/widget","esri/widgets/Widget","dojo/date/locale"],function(e,t,a,o,r,i,n,d,s,c,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p="i-events-datefilter",h=function(n){function e(e){var t=n.call(this,e)||this;return t._pickedDate=null,t.menuOptions=t.makeMenuOptions(),t}return a(e,n),e.prototype.beforeActivate=function(e){},e.prototype.makeMenuOptions=function(){var e=r.default.getInstance().i18n,t=[{label:e.events.dateFilter.any,subcaption:e.events.dateFilter.any,value:null,checked:!1},{label:e.events.dateFilter.today,subcaption:e.events.dateFilter.today,value:"today",checked:!0},{label:e.events.dateFilter.tomorrow,subcaption:e.events.dateFilter.tomorrow,value:"tomorrow",checked:!1},{label:e.events.dateFilter.thisweek,subcaption:e.events.dateFilter.thisweek,value:"thisweek",checked:!1},{label:e.events.dateFilter.thismonth,subcaption:e.events.dateFilter.thismonth,value:"thismonth",checked:!1},{label:e.events.dateFilter.pickdate,subcaption:null,value:"pickdate",checked:!1}];return this.selectedMenuOption=t[1],t},e.prototype.makeWhere=function(e,t){var n,a,o,r=null,i=this.getSelectedMenuOptionValue(),s=t.dateStartField,c=Date.now();if("today"===i)n=new Date(c),a=d.toStartOfDay(n),o=d.toEndOfDay(n),r=d.getRangeClause(s,a,o),e.refDate=a;else if("tomorrow"===i)(n=new Date(c)).setDate(n.getDate()+1),a=d.toStartOfDay(n),o=d.toEndOfDay(n),r=d.getRangeClause(s,a,o),e.refDate=a;else if("thisweek"===i){var l=(a=new Date(c)).getDay();a.setDate(a.getDate()-l),(o=new Date(a.getTime())).setDate(o.getDate()+6),a=d.toStartOfDay(a),o=d.toEndOfDay(o),r=d.getRangeClause(s,a,o)}else"thismonth"===i?(n=new Date(c),a=new Date(n.getFullYear(),n.getMonth(),1),o=new Date(n.getFullYear(),n.getMonth()+1,0),a=d.toStartOfDay(a),o=d.toEndOfDay(o),r=d.getRangeClause(s,a,o)):"pickdate"===i&&void 0!==this._pickedDate&&null!==this._pickedDate&&(n=new Date(this._pickedDate.getTime()),a=d.toStartOfDay(n),o=d.toEndOfDay(n),r=d.getRangeClause(s,a,o),e.refDate=a);return r},e.prototype.menuOptionClicked=function(e){this.dropdownIsActive=!1,"pickdate"===e.value?this.showCalendar(e):e.checked||(this.checkMenuOption(e.value),this._pickedDate=null,this.selectedMenuOption=e,this.emit("changed",{}))},e.prototype.render=function(){var e=r.default.getInstance().i18n;return c.tsx("div",{key:"i-main",class:p},this.renderDropdownButton(e.events.dateFilter.caption),this.renderDropdownMenu())},e.prototype.showCalendar=function(t){var n=this,e=new i.default;e.onChange=function(e){t.subcaption=u.format(e,{selector:"date",formatLength:"short"}),n.checkMenuOption(t.value),n._pickedDate=e,n.selectedMenuOption=t,n.emit("changed",{})},e.show(this._pickedDate)},e=o([s.subclass("app.events.DateFilter")],e)}(s.declared(l,n.default));t.default=h});