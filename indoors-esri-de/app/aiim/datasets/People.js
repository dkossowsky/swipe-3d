var __extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__decorate=this&&this.__decorate||function(e,t,r,o){var i,n=arguments.length,a=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var u=e.length-1;0<=u;u--)(i=e[u])&&(a=(n<3?i(a):3<n?i(t,r,a):i(t,r))||a);return 3<n&&a&&Object.defineProperty(t,r,a),a};define(["require","exports","esri/core/tsSupport/declareExtendsHelper","esri/core/tsSupport/decorateHelper","esri/core/tsSupport/assignHelper","../../context/Context","./Dataset","./FieldNames","../util/aiimUtil","../util/searchUtil","esri/core/accessorSupport/decorators","esri/core/promiseUtils"],function(e,t,o,i,r,c,n,a,u,p,l,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(r){function e(e){var t=r.call(this,e)||this;return t.emailField=a.default.PEOPLE_EMAIL,t.fullNameField=a.default.PEOPLE_FULLNAME,t.unitIDField=a.default.PEOPLE_UNIT_ID,t.type="feature",t}return o(e,r),e.prototype.checkSchema=function(){var o=this;return s.create(function(e,t){if(o.layer2D){var r=o.layer2D;r.when(function(){o.checkFieldNameProperty("emailField",r.fields),o.checkFieldNameProperty("fullNameField",r.fields),o.checkFieldNameProperty("unitIDField",r.fields),e()})}else e()})},e.prototype.getSource=function(){return c.default.getInstance().aiim.datasets.categories.findSourceByKey("People")},e.prototype.getUnitID=function(e){return u.getAttributeValue(e.attributes,this.unitIDField)},e.prototype.isPeopleLayer=function(e,t){if(t){var r=0;return t.some(function(e){var t=e.name.toLowerCase();return(t===a.default.PEOPLE_FULLNAME.toLowerCase()||t===a.default.PEOPLE_EMAIL.toLowerCase())&&2<=++r})}return!1},e.prototype.queryAppUser=function(){var l=this;return s.create(function(t,r){var o=l.url,e=l.emailField,i=l.fullNameField,n=c.default.getInstance().user.getEmail(),a=c.default.getInstance().user.getFullName(),u=l.getSource();p.queryFieldValue(u,o,e,n).then(function(e){return e&&e.features&&1===e.features.length?e:p.queryFieldValue(u,o,i,a)}).then(function(e){t(e)}).catch(function(e){r(e)})})},i([l.property()],e.prototype,"emailField",void 0),i([l.property()],e.prototype,"fullNameField",void 0),i([l.property()],e.prototype,"unitIDField",void 0),i([l.property()],e.prototype,"type",void 0),e=i([l.subclass("app.aiim.datasets.People")],e)}(l.declared(n.default));t.default=f});