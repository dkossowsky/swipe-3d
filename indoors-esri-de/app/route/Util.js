var __extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__decorate=this&&this.__decorate||function(e,t,r,i){var s,o=arguments.length,n=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;0<=a;a--)(s=e[a])&&(n=(o<3?s(n):3<o?s(t,r,n):s(t,r))||n);return 3<o&&n&&Object.defineProperty(t,r,n),n};define(["require","exports","esri/core/tsSupport/declareExtendsHelper","esri/core/tsSupport/decorateHelper","esri/core/tsSupport/assignHelper","../context/Context","esri/core/Accessor","esri/core/accessorSupport/decorators","esri/widgets/Directions/support/maneuverUtils","dojo/number","dojo/_base/kernel"],function(e,t,r,i,s,f,o,n,a,m,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=f.default.checkMixedContent(e.toUrl("esri/themes/base/images/maneuvers/")),p=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.convertDistance=function(e,t,r){var i=this.toMeters(e,t);return this.fromMeters(i,r)},e.prototype.convertTime=function(e,t,r){var i=this.toMinutes(e,t);return this.fromMinutes(i,r)},e.prototype.formatCFDistance=function(e,t,r){var i="",s=f.default.getInstance().i18n.directions.valueUnitsPattern,o=this.convertDistance(e,t,r),n=r.replace("esriNAU","esri").replace("esri","").toLowerCase();if(o||0===o){var a=m.format(o,{locale:"root",places:0});i=s.replace("{value}",a).replace("{units}",n)}return i},e.prototype.formatCFTime=function(e,t){var r="",i=f.default.getInstance().i18n,s=i.directions.valueUnitsPattern,o=this.convertTime(e,t,"esriNAUMinutes");if(o||0===o){var n=i.directions.time.min,a=this.roundMinutes(o),c=m.format(a.minutes,{locale:"root",places:a.places});r=s.replace("{value}",c).replace("{units}",n)}return r},e.prototype.formatDistance=function(e,t,r,i,s){var o="";var n=f.default.getInstance().i18n,a=n.directions.valueUnitsPattern;s||(s=this.getDistanceUnits(e)),i||(i=s);var c=n.directions.units[s],u=this.convertDistance(t,i,s),p=s.replace("esri","").toLowerCase();if(c&&(p=c.abbr),u||0===u){var l=m.format(u,{locale:"root",places:0});o=a.replace("{value}",l).replace("{units}",p)}return o},e.prototype.formatTime=function(e,t,r,i){var s="",o=f.default.getInstance().i18n,n=o.directions.valueUnitsPattern;i||(i=(this.getDirectionsTimeAttribute(e)||{}).units);var a=this.convertTime(t,i,"esriNAUMinutes");if(a||0===a){var c=this.roundMinutes(a),u=o.directions.time.min,p=m.format(c.minutes,{locale:"root",places:c.places});s=n.replace("{value}",p).replace("{units}",u)}return s},e.prototype.roundMinutes=function(e){var t={minutes:e,places:0},r=e;return r<1&&(r<.125?(t.minutes=0,t.places=0):.125<=r&&r<.375?(t.minutes=.25,t.places=2):.375<=r&&r<.625?(t.minutes=.5,t.places=1):.625<=r&&r<.875?(t.minutes=.75,t.places=2):(t.minutes=1,t.places=0)),t},e.prototype.getCostAttribute=function(e,t){for(var r,i=e.serviceDescription,s=i&&i.networkDataset.networkAttributes||[],o=0;o<s.length;o++)if(s[o].name===t&&"esriNAUTCost"===s[o].usageType){r=s[o];break}return r},e.prototype.getDirectionsTimeAttribute=function(e){var t=e.routeParameters,r=e.serviceDescription,i=t&&t.travelMode&&t.travelMode.timeAttributeName||t.directionsTimeAttribute||r.directionsTimeAttribute;return this.getCostAttribute(e,i)},e.prototype.getDistanceUnits=function(e){var t="esriFeet",r=e.routeParameters;if(r&&r.directionsLengthUnits)switch(r.directionsLengthUnits){case"feet":case"esriFeet":t="esriFeet";break;case"miles":case"esriMiles":t="esriMiles";break;case"meters":case"esriMeters":t="esriMeters";break;case"kilometers":case"esriKilometers":t="esriKilometers"}return t},e.prototype.getIconUrl=function(e){if(e){var t=2===window.devicePixelRatio?"@2x":"",r=""+u+e+t+".png";return f.default.checkMixedContent(r)}return null},e.prototype.getLocaleDistanceUnits=function(){return"en-us"===c.locale?"feet":"meters"},e.prototype.getManeuverIconPath=function(e){var t=a.toIconName(e);if(t){var r=2===window.devicePixelRatio?"@2x":"";return""+u+t+r+".png"}return"esriDMTDepart"!==e&&"esriDMTStop"!==e&&console.warn("No icon for maneuver type:",e),null},e.prototype.isTimeUnits=function(e){return"milliseconds"===e||"esriNAUSeconds"===e||"esriNAUMinutes"===e||"esriNAUHours"===e||"esriNAUDays"===e},e.prototype.fromMeters=function(e,t){return this.toMeters(e,t,!0)},e.prototype.fromMinutes=function(e,t){return this.toMinutes(e,t,!0)},e.prototype.toMeters=function(e,t,r){switch(e=e||0,(t||"").replace("esriNAU","esri")){case"esriInches":e*=Math.pow(.0254,r?-1:1);break;case"esriFeet":e*=Math.pow(.3048,r?-1:1);break;case"esriYards":e*=Math.pow(.9144,r?-1:1);break;case"esriMiles":e*=Math.pow(1609.344,r?-1:1);break;case"esriNauticalMiles":e*=Math.pow(1851.995396854,r?-1:1);break;case"esriMillimeters":e/=Math.pow(1e3,r?-1:1);break;case"esriCentimeters":e/=Math.pow(100,r?-1:1);break;case"esriKilometers":e*=Math.pow(1e3,r?-1:1);break;case"esriDecimeters":e/=Math.pow(10,r?-1:1)}return e},e.prototype.toMinutes=function(e,t,r){switch(e=e||0,t){case"milliseconds":e/=Math.pow(6e4,r?-1:1);break;case"esriNAUSeconds":e/=Math.pow(60,r?-1:1);break;case"esriNAUHours":e*=Math.pow(60,r?-1:1);break;case"esriNAUDays":e*=Math.pow(1440,r?-1:1)}return e},e=i([n.subclass("app.route.Util")],e)}(n.declared(o));t.default=p});