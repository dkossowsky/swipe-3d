var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__decorate=this&&this.__decorate||function(e,t,r,n){var a,o=arguments.length,i=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;0<=u;u--)(a=e[u])&&(i=(o<3?a(i):3<o?a(t,r,i):a(t,r))||i);return 3<o&&i&&Object.defineProperty(t,r,i),i};define(["require","exports","esri/core/tsSupport/declareExtendsHelper","esri/core/tsSupport/decorateHelper","esri/core/tsSupport/assignHelper","../context/Context","../context/Topic","../aiim/base/ItemReference","../utils/mapUtils","esri/core/Accessor","esri/core/accessorSupport/decorators","esri/core/urlUtils"],function(e,t,r,n,a,f,p,h,y,o,i,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.copyToClipboard=function(e,t,r){var n=f.default.getInstance().i18n;(new h.default).fromSearchResult(t,r);if(!e)return null;var a=r.feature,o=e.getAiimAddressInfo(a),i=y.getGeometryValues(a.geometry),u=o.verticalOrder;"number"==typeof u&&!isNaN(u)&&isFinite(u)||(u=0);var s=this.generateShareUrl(t,r,i.x,i.y,u);if(null!==s){var l=document.createElement("textarea");l.style.position="fixed",l.style.left="0",l.style.top="0",l.style.opacity="0",l.value=s,document.body.appendChild(l),l.focus(),l.select();var c=document.createRange();c.selectNodeContents(l);var d=window.getSelection();d.removeAllRanges(),d.addRange(c),l.setSelectionRange(0,999999),document.execCommand("copy"),document.body.removeChild(l),p.default.publish(p.default.ShowToast,{message:n.infoPanel.messages.locationCopied})}},e.prototype.generateMailtoToURL=function(e,t,r,n){var a=f.default.getInstance().i18n,o=(new h.default).fromSearchResult(t,r),i=r.feature;if(e&&o){var u=e.getAiimAddressInfo(i),s=y.getGeometryValues(i.geometry),l=u.verticalOrder;"number"==typeof l&&!isNaN(l)&&isFinite(l)||(l=0);var c=this.generateShareUrl(t,r,s.x,s.y,l),d=a.infoPanel.actions.share.shareLinkText,p=d=d.replace("{shareLinkUrl}",encodeURIComponent(c));return"mailto:?subject="+a.infoPanel.actions.share.subject+"&body="+p}return null},e.prototype.generateMobileShareUrl=function(e,t,r){var n=window.location.href,a=n.indexOf("?");-1!==a&&(n=n.substring(0,a)),-1!==(a=n.indexOf("#"))&&(n=n.substring(0,a));var o=m.urlToObject(n);if(o&&o.path){var i=o.path.length,u=o.path.toLocaleLowerCase().lastIndexOf("/index.html"),s=o.path.toLocaleLowerCase().lastIndexOf("/kiosk.html");"/"===o.path.charAt(i-1)?o.path=o.path.substring(0,i-1):0<u&&u===i-11?o.path=o.path.substring(0,i-11):0<s&&s===i-11&&(o.path=o.path.substring(0,i-11))}return o.query={},o.query.x=e,o.query.y=t,o.query.l=r,m.addQueryParameters(o.path,o.query)},e.prototype.generateShareUrl=function(e,t,r,n,a){var o=new h.default;if(o.fromSearchResult(e,t)){var i=window.location.href,u=i,s=u.indexOf("?");-1!==s&&(u=u.substring(0,s)),-1!==(s=u.indexOf("#"))&&(u=u.substring(0,s));var l=m.urlToObject(i);if(l.path=u,l&&l.path){var c=l.path.length,d=l.path.toLocaleLowerCase().lastIndexOf("/index.html"),p=l.path.toLocaleLowerCase().lastIndexOf("/kiosk.html");"/"===l.path.charAt(c-1)?l.path=l.path.substring(0,c-1):0<d&&d===c-11?l.path=l.path.substring(0,c-11):0<p&&p===c-11&&(l.path=l.path.substring(0,c-11))}return l.query||(l.query={}),l.query.itemSourceKey=o.sourceKey,l.query.itemUniqueIdField=o.uniqueIdField,l.query.itemUniqueId=o.uniqueId,l.query.x=r,l.query.y=n,l.query.l=a,m.addQueryParameters(l.path,l.query)}return null},e.prototype.generateWebappUrl=function(e,t){var r=new h.default;if(r.fromSearchResult(e,t)){var n=window.location.href,a=n,o=a.indexOf("?");-1!==o&&(a=a.substring(0,o)),-1!==(o=a.indexOf("#"))&&(a=a.substring(0,o));var i=m.urlToObject(n);return i.query||(i.query={}),i.query.itemSourceKey=r.sourceKey,i.query.itemUniqueIdField=r.uniqueIdField,i.query.itemUniqueId=r.uniqueId,m.addQueryParameters(a,i.query)}return null},e=n([i.subclass("app.infopanel.ShareLocation")],e)}(i.declared(o));t.default=u});